repos:
  - repo: local
    hooks:
      - id: black
        name: black
        entry: backend/venv/bin/black
        language: system
        types: [python]
        files: ^backend/
        args: [--line-length=120]

      - id: isort
        name: isort
        entry: backend/venv/bin/isort
        language: system
        types: [python]
        files: ^backend/
        args: [--profile=black, --line-length=120]

      - id: ruff
        name: ruff
        entry: backend/venv/bin/ruff check --fix --exit-non-zero-on-fix
        language: system
        types: [python]
        files: ^backend/

      - id: check-yaml
        name: check yaml
        entry: python3 -c "import yaml, sys; [yaml.safe_load(open(f)) for f in sys.argv[1:]]"
        language: system
        files: \.(yaml|yml)$

      - id: check-json
        name: check json
        entry: python3 -c "import json, sys; [json.load(open(f)) for f in sys.argv[1:]]"
        language: system
        files: \.json$
        exclude: package-lock\.json$

      - id: debug-statements
        name: debug statements
        entry: python3 -c "import sys, re; files=[f for f in sys.argv[1:] if re.search(r'\\b(pdb\\.set_trace|breakpoint)\\s*\\(', open(f).read())]; sys.exit(1) if files else None"
        language: system
        types: [python]
        files: ^backend/
